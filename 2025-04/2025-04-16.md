# Questions
### 問題6: RelationshipsControllerのdestroyアクションで、特定のフォロー関係を見つけるために使用するパラメータは何ですか？
- params[:relationship_id]
- 不正解です。

- 正解:
```
params[:followed_id] または params[:id]
```

### 解説
RelationshipsControllerのdestroyアクションでは、一般的に2つのアプローチがあります：

#### followed_idを使用する方法：
```
def destroy
  @user = User.find(params[:followed_id])
  relationship = current_user.active_relationships.find_by(followed_id: params[:followed_id])
  relationship.destroy
  redirect_to user_profile_path(@user)
end
```
この場合、「誰をフォロー解除するか」を示すfollowed_idパラメータを使用します。

#### idを使用する方法（RESTfulなアプローチ）：
```
def destroy
  relationship = current_user.active_relationships.find(params[:id])
  @user = relationship.followed
  relationship.destroy
  redirect_to user_profile_path(@user)
end
```
この場合、フォロー関係自体のidパラメータを使用します。
- 今回の実装では、followed_idパラメータを使用していました。
- 実際にはRelationshipモデルから正しいレコードを検索できる方法であれば、どちらのアプローチも有効です。

### 問題1: タグ保存の動作説明
次のコードが実行されたとき、何が起こるでしょうか？
```
rubyclass Article < ApplicationRecord
  has_many :tags

  def save_with_tags(tag_names:)
    ActiveRecord::Base.transaction do
      self.tags = tag_names.map { |name| Tag.find_or_initialize_by(name: name.strip) }
      save!
    end
    true
  rescue StandardError
    false
  end
end

article = Article.new(title: "Railsプログラミング")
article.save_with_tags(tag_names: ["Ruby", " Rails ", nil, "プログラミング"])
```
A) タグ「Ruby」「Rails」「プログラミング」が保存され、trueが返る

### 問題2: トランザクションの理解
以下のコードについて、正しい説明はどれでしょうか？
```
rubydef update_post_with_comments(post, comment_texts)
  ActiveRecord::Base.transaction do
    post.update!(title: "更新後タイトル")
    
    comment_texts.each do |text|
      post.comments.create!(body: text)
    end
  end
  "更新成功"
rescue ActiveRecord::RecordInvalid
  "更新失敗"
end
```
B) コメントの作成に失敗すると、投稿のタイトル変更も取り消される
